!function(t,e,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,t,e),o.mobile}):n(t.jQuery,t,e)}(this,document,function(t,e,n,o){!function(t,e,n,o){var i,a,r="virtualMouseBindings",u="virtualTouchID",c="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),s="clientX clientY pageX pageY screenX screenY".split(" "),h=t.event.mouseHooks?t.event.mouseHooks.props:[],v=t.event.props.concat(h),d={},f=0,l=0,p=0,m=!1,g=[],b=!1,D=!1,T="addEventListener"in n,k=t(n),y=1,P=0;function X(t){for(;t&&void 0!==t.originalEvent;)t=t.originalEvent;return t}function Y(e){for(var n,o,i={};e;){for(o in n=t.data(e,r))n[o]&&(i[o]=i.hasVirtualBinding=!0);e=e.parentNode}return i}function w(){D=!0}function E(){D=!1}function I(){M(),f=setTimeout(function(){f=0,P=0,g.length=0,b=!1,w()},t.vmouse.resetTimerDuration)}function M(){f&&(clearTimeout(f),f=0)}function B(e,n,i){var a;return(i&&i[e]||!i&&function(e,n){for(var o;e;){if((o=t.data(e,r))&&(!n||o[n]))return e;e=e.parentNode}return null}(n.target,e))&&(a=function(e,n){var i,a,r,u,c,h,d,f,l,p=e.type;if((e=t.Event(e)).type=n,i=e.originalEvent,a=t.event.props,p.search(/^(mouse|click)/)>-1&&(a=v),i)for(d=a.length;d;)e[u=a[--d]]=i[u];if(p.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1),-1!==p.search(/^touch/)&&(p=(r=X(i)).touches,c=r.changedTouches,h=p&&p.length?p[0]:c&&c.length?c[0]:o))for(f=0,l=s.length;f<l;f++)e[u=s[f]]=h[u];return e}(n,e),t(n.target).trigger(a)),a}function N(e){var n,o=t.data(e.target,u);b||P&&P===o||(n=B("v"+e.type,e))&&(n.isDefaultPrevented()&&e.preventDefault(),n.isPropagationStopped()&&e.stopPropagation(),n.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}function j(e){var n,o,i,a=X(e).touches;a&&1===a.length&&(o=Y(n=e.target)).hasVirtualBinding&&(P=y++,t.data(n,u,P),M(),E(),m=!1,i=X(e).touches[0],l=i.pageX,p=i.pageY,B("vmouseover",e,o),B("vmousedown",e,o))}function x(t){D||(m||B("vmousecancel",t,Y(t.target)),m=!0,I())}function H(e){if(!D){var n=X(e).touches[0],o=m,i=t.vmouse.moveDistanceThreshold,a=Y(e.target);(m=m||Math.abs(n.pageX-l)>i||Math.abs(n.pageY-p)>i)&&!o&&B("vmousecancel",e,a),B("vmousemove",e,a),I()}}function L(t){if(!D){w();var e,n,o=Y(t.target);B("vmouseup",t,o),m||(e=B("vclick",t,o))&&e.isDefaultPrevented()&&(n=X(t).changedTouches[0],g.push({touchID:P,x:n.clientX,y:n.clientY}),b=!0),B("vmouseout",t,o),m=!1,I()}}function S(e){var n,o=t.data(e,r);if(o)for(n in o)if(o[n])return!0;return!1}function V(){}function q(e){var n=e.substr(1);return{setup:function(){S(this)||t.data(this,r,{}),t.data(this,r)[e]=!0,d[e]=(d[e]||0)+1,1===d[e]&&k.bind(n,N),t(this).bind(n,V),T&&(d.touchstart=(d.touchstart||0)+1,1===d.touchstart&&k.bind("touchstart",j).bind("touchend",L).bind("touchmove",H).bind("scroll",x))},teardown:function(){--d[e],d[e]||k.unbind(n,N),T&&(--d.touchstart,d.touchstart||k.unbind("touchstart",j).unbind("touchmove",H).unbind("touchend",L).unbind("scroll",x));var o=t(this),i=t.data(this,r);i&&(i[e]=!1),o.unbind(n,V),S(this)||o.removeData(r)}}}for(t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},a=0;a<c.length;a++)t.event.special[c[a]]=q(c[a]);T&&n.addEventListener("click",function(e){var n,o,a,r,c,s=g.length,h=e.target;if(s)for(n=e.clientX,o=e.clientY,i=t.vmouse.clickDistanceThreshold,a=h;a;){for(r=0;r<s;r++)if(c=g[r],0,a===h&&Math.abs(c.x-n)<i&&Math.abs(c.y-o)<i||t.data(a,u)===c.touchID)return e.preventDefault(),void e.stopPropagation();a=a.parentNode}},!0)}(t,0,n)});
 

